<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>HOME CHEF</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <link rel="stylesheet" type="text/css" href="favourites.css">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="https://smtpjs.com/v3/smtp.js"></script>	
    <script src="favourites.js"></script>
    <!--slider-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <!--slider-->

</head>

<body>
    <div data-role="page" id="aboutuspage">

        <div data-role="header" data-position="fixed" data-tap-toggle="false" id="header">

            <div class="mhead">
                <a class="back-btn" href="../UserAccount/">
                    < Back</a>
                        <img class="menu-ham2" src="../../Assets/img/rectangle_logo_black.png">
            </div>
            <!-- /grid-b -->
        </div>
        <!-- /header -->


        <!-- content -->
        <div data-role="content">
        <h1 id="header1">Favourites</h1> 
        <div class="container-fluid">
            <div class="col-xs-11">
                <form>
                    <input data-type="search" id="divOfPs-input">
                </form>     
               
            </div>
            <div class="col-xs-1">
             <a href="#addItem-popup" data-rel="popup" data-position-to="window" data-transition="pop" class="addPoints"><img id= "email" src="../../Assets/img/icons/send-mail.svg" alt="Email-icon"></a>
                
            </div>
            </div>
            <hr>
            		
            <ul id="di" data-filter="true" data-input="#divOfPs-input" data-filter-placeholder="Search">

            <div id="item1" class=" ui-child uu">
                <a href="#"  data-ajax="false" >
                    <div style="position: relative;">
                        <img src="../../Assets/img/pizza.jpg" id="img-fav">
                        <img src="../../Assets/img/icons/liked-heart.svg" id="heart-unheart" class="heart-icon" width="33" height="33" onclick="amend(1)">
                    </div >
                    <h2 id="prod-n">Arthur's Pizza</h2>
                    <span id="address">No.5, Temple's road, Rathmalana</span>
                </a>
            </div>
            <div id="item2" class="ui-child uu">
                <a href="#"  data-ajax="false" >
                    <div style="position: relative;">
                        <img src="../../Assets/img/cupcakes.jpg" id="img-fav">
                        <img src="../../Assets/img/icons/liked-heart.svg" id="heart-unheart" class="heart-icon" width="33" height="33" onclick="amend(2)">
                    </div >
                    <h2 id="prod-n">Street Burger</h2>
                    <span id="address">No.6, Marine Drive, Colpetty</span>
                    
                </a>
            </div>
            <div id="item3" class="ui-child uu">
                <a href="#"  style="padding:0px; ;">
                    <div style="position: relative;">
                        <img src="../../Assets/img/kottu.jpg" id="img-fav">
                        <img src="../../Assets/img/icons/liked-heart.svg" id="heart-unheart" class="heart-icon" width="33" height="33" onclick="amend(3)">
                    </div >
                    <h2 id="prod-n">Cauldron</h2>
                    <span id="address">No.4, W A Mawatha, Wellawatte</span>
                    
                </a>
            </div>
            </ul>
           
            <!-- popup success -->
            <div data-role="popup" id="add-popup-success">
                <div data-role="content">
                    <a href="#" data-rel="back" id="popupback">
                        <img src="../../Assets/img/icons/close.png" id="promo-add-btn" height="15" width="15"></a>
                    <br>
                    <center><img id="av" src="../../Assets/img/icons/orange-tick-icon.png" width="85" height="85"></center>
                    <h3 class="text-center" id="header1">Favourite list was Emailed Successfully!</h1>
                        <br>
                </div>
            </div>

            <!-- popup email deatils -->
            <div data-role="popup" id="addItem-popup">
                <div data-role="content">
                    <a href="#" data-rel="back" id="popupback"> <img src="../../Assets/img/icons/close.png" id="" height="15" width="15"></a>
                    <br>
                    <h2 class="text-center" id="header1">Share your Favourite List via Email</h2>
                    <br>
                    <center><img id="av" src="../../Assets/img/icons/send-mail.svg"></center>
                    <h4 class="text-center" id="he2"></h4>
                    <center>
                        <input type="text" name="user" id="un" value="" placeholder="Reciever's Email" data-role=none required/>
                        <input type="text" name="user" id="us" value="" placeholder="Description" data-role=none required/>
                        <a href="#" data-role="button" id="submits" onclick="sendEmail()">SEND</a>
                    </center>
                </div>
            </div>

        <!-- /content -->

        

    </div>
    <!-- /page -->
</body>

<script type="text/javascript"> 
    function sendEmail() { 
        var x = document.getElementById("un").value;
        var y = document.getElementById("us").value;
        
      Email.send({ 
        Host: "smtp.gmail.com", 
        Username: "epillPod2018@gmail.com", 
        Password: "dbswepzodchmjvcc",
        To: x, 
        From: "epillPod2018@gmail.com", 
        Subject: "My Favourit List from Home Chef", 
        Body: y, 
        Attachments : [
     {
         name : "favourites.jpg",
        path : "https://image.shutterstock.com/image-photo/large-group-junk-food-one-600w-232493077.jpg"

     }]
      }) 
        .then(function (message) { 
        //  var message = "Done"
        console.log(message)
        }); 
    } 

    function amend(val){
        if(val === 1){
            localStorage.setItem("isFavourite", false);
            document.getElementById("item1").style.display="none";
            console.log(val);
        }
        else if(val === 2){
            document.getElementById("item2").style.display="none";
            console.log(val);
        }
        else if(val === 3){
            document.getElementById("item3").style.display="none";
            console.log(val);
        }
        
    }


    var buttonClick = false;
        $(document).on("pageinit", function() {
            $("#addItem-popup").on({
                popupafterclose: function() {
                    if (buttonClick) {
                        setTimeout(function() {
                            $("#add-popup-success").popup("open", {
                                positionTo: "#addItem-popup"
                            })
                        }, 100);
                        buttonClick = false;
                    } else {
                        console.log(buttonClick);
                    }
                }
            });
        });

        $(document).ready(function() {
            $("#submits").click(function() {
                buttonClick = true;
                $("#addItem-popup").popup("close");
            });
        });


    
  </script> 
    
    

</html>